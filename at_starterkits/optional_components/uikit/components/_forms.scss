/**
 * Forms.
 * This probably seems like a lot - remember AT unsets system.theme.css and
 * gives you control over all form elements, so we have to set styles for
 * all drupals complex forms, this makes the theme totally usable in admin.
 *
 * - NOTES:
 *   - input type submit is treated as a 'button', see _buttons.scss
 *   - for drop buttons see _buttons.scss
 */

$form-item-text-align:              center;

$form-item-text-color:              lighten($text-color, 20%); // If text is #000, lighten 20% is #333
$form-item-text-focus-color:        $text-color;

$form-item-help-color:              lighten($text-color, 45%);

$form-item-background-color:        #fff;
$form-item-background-focus-color:  lighten($text-background-color, 5%);

$form-item-border-width:            $border-width;
$form-item-border-style:            $border-style;
$form-item-border-color:            $border-color;
$form-item-border-radius:           $border-radius;



.form-item {
  @include output-rhythm(margin, 0 0 $medium);
}


.form-actions {
  @include output-rhythm(margin, $medium 0);
}


input,
select,
button,
textarea {
  @include adjust-font-size-to($medium);
}


// Select, Textarea and most input types
select,
textarea,
input {
  max-width: 100%;

  &:not([type]),
  &[type="text"],
  &[type="password"],
  &[type="email"],
  &[type="url"],
  &[type="date"],
  &[type="month"],
  &[type="time"],
  &[type="datetime"],
  &[type="datetime-local"],
  &[type="week"],
  &[type="number"],
  &[type="search"],
  &[type="tel"],
  &[type="color"] {
    line-height: normal;
    color: $form-item-text-color;
    border: $form-item-border-width $form-item-border-style $form-item-border-color;
    background-color: $form-item-background-color;


    @include output-rhythm(padding, $xx-small $x-small);
    @include border-radius($form-item-border-radius);
    @include transition(all, .15s, linear);
    @include box-shadow(rgba(0,0,0,0.1) 0 1px 2px inset);

    &:focus {
      outline: 0;
      outline: thin dotted \9; // IE6-9
      border-color: $form-item-border-color;
      color: $form-item-text-focus-color;
    }

    &[disabled] {
      cursor: not-allowed;
      opacity: 0.7;

      &:hover,
      &:focus {
        color: $form-item-text-focus-color;
      }
    }
  }

  // Checkbox and radio
  &[type="checkbox"],
  &[type="radio"] {
    display: inline-block;
    position: relative;
    bottom: 1px;
  }

  // Focus for file, radio and checkbox
  &[type="file"]:focus,
  &[type="radio"]:focus,
  &[type="checkbox"]:focus {}
}


// Readonly
input,
select,
textarea {
  &[readonly] {
    background: $text-background-color;
    color: $text-color;
  }
}


// Focus invalid
input,
textarea,
select {
  &:focus:invalid {}
}


// Select. TODO: js to control selects, i.e. transform into div and list elements.
select {
  /*
  border: $form-item-border-width $form-item-border-style $form-item-border-color;
  background-color: $form-item-background-color;
  color: $form-item-text-color;

  @include output-rhythm(padding, $xx-small $x-small);
  @include border-radius($form-item-border-radius);
  @include appearance(none);
  */

  &[multiple] {
    height: auto;
  }

  > option {
  }
}


// Label
label {
  font-weight: $font-weight-semibold;
  text-decoration: none;
  white-space: nowrap;
  display: block;

  // radio, checkbox options
  &.option {
    font-weight: normal;
    display: inline;
    padding: 0 3px;
  }
}


// Fieldset, reset.
fieldset,
fieldset.form-item {
  border: 0;
  margin: 0;
  padding: 0;
}


// Legend
legend {
}


// Textarea
textarea {
  resize: vertical; // Allow only vertical resizing of textareas.
}


// Tips
.tips {
  font-size: 0.85em;
  color: $form-item-help-color;

  li {
    list-style: none;
  }
}


// Form item descriptions
.description {
  color: $form-item-help-color;
  font-size: 0.85em;
}


// Strip vertical margins inside tables
tr.odd,
tr.even {
  .form-item {
    margin-top: 0;
    margin-bottom: 0;
    white-space: nowrap;
  }
}


// Labels
.form-composite > legend,
h4.label {
  font-size: inherit;
  font-weight: $font-weight-semibold;
  margin: 0;
  padding: 0;
}


// Labels
.marker,
.form-required {
  color: #e00; // very bright red
}


// abbr usesage in drupal forms
abbr {
  &.form-required,
  &.tabledrag-changed,
  &.ajax-changed {
    border-bottom: none;
  }
}


// Errors
.form-item {
  input.error,
  textarea.error,
  select.error {
    border: 2px solid red;
  }
}


// Radio and Checkbox descriptions
.form-type-radio,
.form-type-checkbox {
  .description {
    margin-left: 2.4em;
  }
}


// Radio/s container-inline
.form-type-radios {
  .container-inline {
    label:after {
      content: none;
    }

    .form-type-radio {
      @include output-rhythm(margin, 0 $medium);
    }
  }
}


// Container inline
.container-inline {
  label:after {
    content: ':';
  }

  .form-actions,
  &.form-actions {
    margin-top: 0;
    margin-bottom: 0;
  }
}


// Adjust specific form field types
form {
  .field-type-image {
    .image-preview {
      padding: 0;
      margin: 0 $medium $medium 0; // LTR
      background: transparent;
    }

    .image-widget-data {
      > div:first-child {
        margin-top: 0;
      }
    }
  }
}


// Table drag styles
form {
  .field-edit-link {
    margin: 0 0.3em;
  }

  .field-multiple-table {
    margin: 0;

    .field-multiple-drag {
      width: 30px;
      padding-right: 0; // LTR

      .tabledrag-handle {
        padding-right: .5em; // LTR
      }
    }
  }

  .field-add-more-submit {
    margin: .5em 0 0;
  }
}

// RTL for table drag
[dir="rtl"] form .field-multiple-table .field-multiple-drag {
  padding-left: 0;

  .tabledrag-handle {
    padding-left: .5em;
  }
}


/*
 * Autocomplete.
 *
 * @see autocomplete.js
 */

/* Suggestion list */
.ui-autocomplete li.ui-menu-item a.ui-state-focus,
.autocomplete li.ui-menu-item a.ui-state-hover {
  background: #0072b9;
  color: #fff;
  margin: 0;
}

/**
 * Collapsible details.
 *
 * @see collapse.js
 * @thanks http://nicolasgallagher.com/css-background-image-hacks/
 */
details {
  border: $form-item-border-width $form-item-border-style $form-item-border-color;
  @include border-radius($border-radius);
  @include output-rhythm(margin, $medium 0);

  > .details-wrapper {
    @include output-rhythm(margin, $medium);
  }
}


/* @todo Regression: The summary of uncollapsible details are no longer
     vertically aligned with the .details-wrapper in browsers without native
     details support. */
summary {
  cursor: pointer;
  @include output-rhythm(padding, $x-small);
}

.collapse-processed {
  > summary {
    @include output-rhythm(padding, $x-small);

    &:before {
      font-family: FontAwesome, sans-serif;
      content: "\f0d7"; // fa-caret-down
      float: left;
      margin: -1px 0 0;
      @include output-rhythm(height, $medium);
      @include output-rhythm(width, $medium);
    }
  }
}

.collapse-processed:not([open]) > summary:before {
  content: "\f0da"; // LTR, fa-caret-right
}


// RTL for collapsible elements (mainly details)
[dir="rtl"] {
  .collapse-processed > summary:before {
    float: right;
  }

  .collapse-processed:not([open]) > summary:before {
    content: "\f0d9"; // RTL, fa-caret-left
  }
}


// Special case for blocks config page to be nice.
.block-list-secondary {
  border-bottom-width: 1px;
  @include box-sizing(border-box);
  @include output-rhythm(padding, 0 $small);
}





