/**
 * Navigation.
 *  - navbar menu
 *  - drop menu
 *
 * Maybe dependant on the Menu twig patch: https://drupal.org/node/1898478
 */

$navbar-menu-background:    $page-row-navbar-background-color;

$navbar-item-border-width:  $border-width;
$navbar-item-border-style:  $border-style;
$navbar-item-border-color:  $border-color;
$navbar-item-border-radius: $border-radius;

.region__navbar {
  background: $navbar-menu-background;

  .menu {
    position: relative;
    font-size: 0; // remove extra margin added by using inline-block on li

    > li {
      z-index: 100;

      a {
        @include transition(all, .2s, ease-in);

        &:hover,
        &:focus {
          text-decoration: none;
          background: lighten($navbar-menu-background, 3%);
        }
      }
    }

    li {
      position: relative;
      vertical-align: middle;
      background: $navbar-menu-background;
      @include adjust-font-size-to($medium); // explicitly set the font-size since the container is font-size 0

      &:hover > ul,
      &:focus > ul {}
    }

    a {
      color: $page-row-navbar-color;
    }
  }
}

@media #{$mobile} {

  // Basic styles for mobile.
  .region__navbar {
    // Nuke contextual links in mobile view.
    .contextual-region {
      position: static !important;
      .contextual {
        @include visually-hidden;
      }
    }

    .menu {
      li {
        a:after {
          content: '';
        }
        ul {
          @include output-rhythm(padding, 0);

          ul {
            @include output-rhythm(padding, 0 0 0 $medium); // LTR
          }

          a {
            @include output-rhythm(padding, $xx-small);

            &:after {
              font-family: FontAwesome, sans-serif;
              float: left; // LTR
              @include output-rhythm(padding, 0 $large 0 0);
              text-align: right; // LTR
              content: "\f105"; // LTR
              @include output-rhythm(width, $medium);
            }
          }
        }
      }
    }
  }

  .menu-style-tile {
    .region__navbar {
      .block-menu__title {
        @include visually-hidden;
      }
      .block-menu__content {
        // do nothing?
      }
    }
  }

  // Toggle links styles for slidedown and offcanvas styles.
  .menu-style-slidedown,
  .menu-style-offcanvas {
    .region__navbar {
      .block-menu__title {
        @include adjust-font-size-to($medium);
        @include output-rhythm(padding, $xx-small 0);
        cursor: pointer;

        &:after {
          font-family: FontAwesome, sans-serif;
          content: "\f0c9";
          @include output-rhythm(width, $medium);
        }
      }
    }
  }

  // Slidedown styles.
  .menu-style-slidedown {
    .region__navbar {
      .block-menu__content {
        @include visually-hidden;
        @include opacity(.3);
        @include transition(all, .2s, ease);
      }
    }
    &.menu-expanded .region__navbar {
      .block-menu__title {
        &:after {
          float: right; // LTR
          text-align: right; // LTR
        }
      }

      .block-menu__content {
        @include visually-hidden-off;
        @include opacity(1);
        @include output-rhythm(padding, 0 0 $xx-small);
      }
    }
  }

  // Off canvas styles.
  .menu-style-offcanvas {
    .region__navbar {
      .block-menu__content {
        position: absolute;
        top: 0;
        width: 240px;
        @include output-rhythm(padding, 0 0 $xx-small);
      }
    }

    .page-root {
      @include transition(all, .2s, ease-in-out);
    }

    &.offcanvas-left .region__navbar {
      .block-menu__title {
        &:after {
          float: left; // LTR
          text-align: left; // LTR
          @include output-rhythm(margin, -1px $small 0 0);
        }
      }
      .block-menu__content {
        left: 0;
        @include transform(translate3d(-240px, 0, 0));
      }
    }

    &.offcanvas-right .region__navbar {
      .block-menu__title {
        text-align: right;
        &:after {
          float: right;
          text-align: right;
          @include output-rhythm(margin, -1px 0 0 $small);
        }
      }
      .block-menu__content {
        right: 0;
        @include transform(translate3d(240px, 0, 0));
      }
    }

    &.menu-expanded.offcanvas-left .page-root {
      @include transform(translate3d(240px, 0, 0));
    }

    &.menu-expanded.offcanvas-right .page-root {
      @include transform(translate3d(-240px, 0, 0));
    }
  }
}

@media #{$wide} {
  .region__navbar {
     background: $navbar-menu-background;

    .block-menu__title {
      @include visually-hidden;
    }
  }

  .region__navbar {
    background: $navbar-menu-background;

    .menu {
      position: relative;
      font-size: 0; // remove extra margin added by using inline-block on li

      > li {
        text-align: center;
        border-left: 1px dotted rgba(255,255,255,0.3);

        &:last-child {
          border-right: 1px dotted rgba(255,255,255,0.3);
        }

        a {
          &:hover,
          &:focus {
          }
        }
      }

      li {
        display: inline-block;
        min-width: 10em;

        ul {
          position: absolute;
          overflow: hidden;
          height: 0;
          opacity: 0;
          @include transition(height, .3s, ease-in);

          li {
            text-align: left; // LTR

            &.expanded > a:after {
              content: "\f105"; // fa-angle-down
            }

            ul {
              left: 100%;
              top: 0;

              li {
                &.expanded > a:after {
                  content: "\f107"; // fa-angle-down
                }
              }

              a {
                color: green !important;
              }

              ul {
                left: 0;
                top: auto;

                a {
                  color: pink !important;
                }
              }
            }
          }
        }

        &:hover > ul,
        &:focus > ul {
          display: block;
          opacity: 1;
          height: auto;
          overflow: visible;
        }
      }
    }
    a {
      @include output-rhythm(padding, $xx-small $large);
    }
  }
}

